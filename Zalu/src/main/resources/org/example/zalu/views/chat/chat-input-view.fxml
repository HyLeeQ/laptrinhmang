<?xml version="1.0" encoding="UTF-8"?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<?import javafx.geometry.Insets?>
<VBox xmlns="http://javafx.com/javafx/21" xmlns:fx="http://javafx.com/fxml/1"
      fx:controller="org.example.zalu.controller.chat.ChatController"
      spacing="0" styleClass="chat-input-container">
    
    <!-- File preview panel (hiá»ƒn thá»‹ khi cÃ³ file Ä‘ang gá»­i) -->
    <HBox fx:id="filePreviewPanel" styleClass="file-preview-panel" visible="false" managed="false"
          alignment="CENTER_LEFT" spacing="12">
        <padding><Insets top="12" right="20" bottom="12" left="20"/></padding>
        <Label fx:id="filePreviewIcon" text="ðŸ“Ž" styleClass="file-preview-icon"/>
        <VBox spacing="4" HBox.hgrow="ALWAYS">
            <Label fx:id="filePreviewLabel" text="File" styleClass="file-preview-label"/>
            <Label fx:id="filePreviewSize" text="0 KB" styleClass="file-preview-size"/>
            <ProgressBar fx:id="fileProgressBar" visible="false" managed="false" prefWidth="200" prefHeight="4" styleClass="file-progress-bar"/>
        </VBox>
        <Button fx:id="filePreviewCancelBtn" text="âœ•" styleClass="file-preview-cancel-btn" onAction="#cancelFilePreview"/>
    </HBox>
    
    <!-- Voice preview panel (hiá»ƒn thá»‹ khi cÃ³ voice Ä‘Ã£ ghi) -->
    <HBox fx:id="voicePreviewPanel" styleClass="voice-preview-panel" visible="false" managed="false"
          alignment="CENTER_LEFT" spacing="12">
        <padding><Insets top="12" right="20" bottom="12" left="20"/></padding>
        <Label text="ðŸŽ¤" styleClass="voice-preview-icon"/>
        <VBox spacing="4" HBox.hgrow="ALWAYS">
            <Label fx:id="voicePreviewLabel" text="Tin nháº¯n thoáº¡i" styleClass="voice-preview-label"/>
            <Label fx:id="voicePreviewSize" text="0 KB" styleClass="voice-preview-size"/>
        </VBox>
        <Button fx:id="voicePreviewCancelBtn" text="âœ•" styleClass="voice-preview-cancel-btn" onAction="#cancelVoicePreview"/>
    </HBox>
    
    <!-- Recording panel (hiá»ƒn thá»‹ khi Ä‘ang ghi Ã¢m) -->
    <HBox fx:id="recordingPanel" styleClass="recording-panel" visible="false" managed="false"
          alignment="CENTER" spacing="12">
        <padding><Insets top="12" right="20" bottom="12" left="20"/></padding>
        <Label text="ðŸ”´" styleClass="recording-icon"/>
        <Label fx:id="recordingTimeLabel" text="00:00" styleClass="recording-time-label"/>
        <Region HBox.hgrow="ALWAYS"/>
        <Button fx:id="stopRecordingButton" text="Dá»«ng" styleClass="stop-recording-btn" onAction="#stopVoiceRecording"/>
    </HBox>
    
    <!-- Reply preview panel (hiá»ƒn thá»‹ khi Ä‘ang reply má»™t tin nháº¯n) -->
    <HBox fx:id="replyPreviewPanel" styleClass="reply-preview-panel" visible="false" managed="false"
          alignment="CENTER_LEFT" spacing="12">
        <padding><Insets top="12" right="20" bottom="12" left="20"/></padding>
        <Label text="â†©" styleClass="reply-preview-icon"/>
        <VBox spacing="2" HBox.hgrow="ALWAYS">
            <Label text="Tráº£ lá»i:" styleClass="reply-preview-label" style="-fx-font-size: 11px; -fx-text-fill: #8e8e93;"/>
            <Label fx:id="replyPreviewContent" text="" styleClass="reply-preview-content" style="-fx-font-size: 13px; -fx-text-fill: #1c1e21;"/>
        </VBox>
        <Button fx:id="replyPreviewCancelBtn" text="âœ•" styleClass="reply-preview-cancel-btn" onAction="#cancelReply"/>
    </HBox>

    <!-- Input bar -->
    <HBox alignment="CENTER" spacing="8" styleClass="input-bar">
        <padding><Insets top="16" right="20" bottom="16" left="20"/></padding>

        <Button text="ðŸ“Ž" styleClass="input-icon" onAction="#handleSendFile"/>
        <Button fx:id="voiceButton" text="ðŸŽ¤" styleClass="input-icon" onAction="#handleVoiceMessage"/>

        <TextField fx:id="messageField" promptText="Nháº­p tin nháº¯n..."
                   styleClass="message-input" HBox.hgrow="ALWAYS"/>

        <Button fx:id="emojiButton" text="ðŸ˜Š" styleClass="input-icon" onAction="#handleEmojiPicker"/>
        <Button text="ðŸ‘" styleClass="input-icon" onAction="#handleSendLike"/>

        <Button fx:id="sendButton" text="Gá»­i" styleClass="send-button" onAction="#sendMessage"/>
    </HBox>
</VBox>